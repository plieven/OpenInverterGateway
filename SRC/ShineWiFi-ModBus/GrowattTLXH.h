#pragma once

#include "Arduino.h"

#include "Growatt.h"
#include "GrowattTypes.h"

// Growatt modbus protocol version 1.24 from 2020-08-04
typedef enum {
  P3000_INVERTER_STATUS = 0,
  P3000_INVERTER_RUNSTATE,
  P3000_PPV,
  P3000_VPV1,
  P3000_IPV1,
  P3000_PPV1,
  P3000_VPV2,
  P3000_IPV2,
  P3000_PPV2,
  P3000_VPV3,
  P3000_IPV3,
  P3000_PPV3,
  P3000_VPV4,
  P3000_IPV4,
  P3000_PPV4,
  P3000_PSYS,
  P3000_QAC,
  P3000_PAC,
  P3000_FAC,
  P3000_VAC1,
  P3000_IAC1,
  P3000_PAC1,
  P3000_VAC2,
  P3000_IAC2,
  P3000_PAC2,
  P3000_VAC3,
  P3000_IAC3,
  P3000_PAC3,
  P3000_VAC_RS,
  P3000_VAC_ST,
  P3000_VAC_TR,
  P3000_PTOUSER_TOTAL,
  P3000_PTOGRID_TOTAL,
  P3000_PTOLOAD_TOTAL,
  P3000_TIME_TOTAL,
  P3000_EAC_TODAY,
  P3000_EAC_TOTAL,
  P3000_EPV_TOTAL,
  P3000_EPV1_TODAY,
  P3000_EPV1_TOTAL,
  P3000_EPV2_TODAY,
  P3000_EPV2_TOTAL,
  P3000_EPV3_TODAY,
  P3000_EPV3_TOTAL,
  P3000_ETOUSER_TODAY,
  P3000_ETOUSER_TOTAL,
  P3000_ETOGRID_TODAY,
  P3000_ETOGRID_TOTAL,
  P3000_ELOAD_TODAY,
  P3000_ELOAD_TOTAL,
  P3000_EPV4_TODAY,
  P3000_EPV4_TOTAL,
  P3000_EPV_TODAY,
  P3000_DERATING_MODE,
  P3000_ISO,
  P3000_DCI_R,
  P3000_DCI_S,
  P3000_DCI_T,
  P3000_GFCI,
  P3000_BUS_VOLTAGE,
  P3000_TEMP1,
  P3000_TEMP2,
  P3000_TEMP3,
  P3000_TEMP5,
  P3000_P_BUS_VOLTAGE,
  P3000_N_BUS_VOLTAGE,
  P3000_IPF,
  P3000_REALOPPERCENT,
  P3000_OPFULLWATT,
  P3000_FAULT_MAINCODE,
  P3000_WARN_MAINCODE,
  P3000_AFCI_STATUS,
  P3000_INV_START_DELAY,
  P3000_BDC_ONOFFSTATE,
  P3000_DRYCONTACTSTATE,
  P3000_PSELF,
  P3000_ESYS_TODAY,
  P3000_EDISCHR_TODAY,
  P3000_EDISCHR_TOTAL,
  P3000_ECHR_TODAY,
  P3000_ECHR_TOTAL,
  P3000_EACCHR_TODAY,
  P3000_EACCHR_TOTAL,
  P3000_ESYS_TOTAL,
  P3000_ESELF_TODAY,
  P3000_ESELF_TOTAL,
  P3000_PRIORITY,
  P3000_BDC_DERATINGMODE,
  P3000_BDC_SYSSTATE,
  P3000_BDC_SYSMODE,
  P3000_BDC_FAULTCODE,
  P3000_BDC_WARNCODE,
  P3000_BDC_VBAT,
  P3000_BDC_IBAT,
  P3000_BDC_SOC,
  P3000_BDC_VBUS1,
  P3000_BDC_VBUS2,
  P3000_BDC_IBB,
  P3000_BDC_ILLC,
  P3000_BDC_TEMPA,
  P3000_BDC_TEMPB,
  P3000_BDC_PDISCHR,
  P3000_BDC_PCHR,
  P3000_BDC_EDISCHR_TOTAL,
  P3000_BDC_ECHR_TOTAL,
  P3000_INPUT_REGISTER_COUNT
} eP3000InputRegisters_t;

typedef enum {
  P3000_ACTIVE_P_RATE,
  P3000_BDC_DISCHARGE_P_RATE,
  P3000_BDC_DISCHARGE_STOPSOC,
  P3000_BDC_CHARGE_P_RATE,
  P3000_BDC_CHARGE_STOPSOC,
  P3000_BDC_CHARGE_AC_ENABLED,
  P3000_HOLING_REGISTER_COUNT
} eP3000HoldingRegisters_t;

void init_growattTLXH(sProtocolDefinition_t &Protocol, Growatt &inverter);
